<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>安全防护机制 - Proxy 101</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body class="light-mode">
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>Proxy 101</h1>
                <p class="nav-tagline">全面的代理知识库</p>
            </div>
            <div class="nav-actions">
                <a class="nav-icon-link" href="https://github.com/zhichao12/proxy-101" target="_blank" rel="noopener" aria-label="GitHub 仓库">
                    <svg viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8Z"/>
                    </svg>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                    <span class="theme-icon">🌙</span>
                </button>
            </div>
        </div>
    </nav>

    <div class="container">
        <aside class="sidebar">
            <nav class="sidebar-nav">
                                    <div class="nav-section">
                    <h3>基础理论</h3>
                    <ul>
                        <li><a href="basics.html">代理基础概念</a></li>
                        <li><a href="terminology.html">核心术语解析</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>VPS 相关</h3>
                    <ul>
                        <li><a href="vps.html">VPS 基础知识</a></li>
                        <li><a href="providers.html">VPS 提供商</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>协议与工具</h3>
                    <ul>
                        <li><a href="protocols.html">代理协议详解</a></li>
                        <li><a href="tools.html">部署工具</a></li>
                        <li><a href="clients.html">客户端推荐</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>网络基础</h3>
                    <ul>
                        <li><a href="icmp.html">ICMP 协议详解</a></li>
                        <li><a href="nat.html">NAT 穿透机制</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>安全与防护</h3>
                    <ul>
                        <li><a href="security.html">安全防护机制</a></li>
                        <li><a href="gfw.html">GFW 检测原理</a></li>
                        <li><a href="ip-blocking.html">IP 封禁机制</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>进阶与实战</h3>
                    <ul>
                        <li><a href="advanced.html">进阶优化</a></li>
                        <li><a href="faq.html">常见问题</a></li>
                    </ul>
                </div>

            </nav>
        </aside>

        <main class="main-content content-page">
            <div class="breadcrumb">
                <a href="../index.html">首页</a>
                <span>/</span>
                <span>安全防护机制</span>
            </div>

            <h1>🛡️ 安全防护机制</h1>

            <h2>SSH 安全加固</h2>
            
            <h3>1. 修改 SSH 端口</h3>
            <div class="info-box">
                <h4>为什么要改？</h4>
                <p>默认 22 端口会被大量扫描和暴力破解，改为非标准端口可以大幅减少攻击。</p>
                
                <h4>操作步骤</h4>
                <pre><code># 编辑 SSH 配置
sudo nano /etc/ssh/sshd_config

# 修改端口（取消注释并改为其他端口）
Port 50022

# 重启 SSH 服务
sudo systemctl restart sshd</code></pre>
                
                <div class="warning-box">
                    <p>⚠️ <strong>重要</strong>：改端口前确保防火墙开放了新端口，否则会无法连接！</p>
                </div>
            </div>

            <h3>2. 禁用密码登录，使用密钥</h3>
            <div class="info-box">
                <h4>生成密钥对（本地执行）</h4>
                <pre><code># 生成 SSH 密钥
ssh-keygen -t ed25519 -C "your_email@example.com"

# 上传公钥到服务器
ssh-copy-id -p 50022 root@your-vps-ip</code></pre>
                
                <h4>禁用密码登录（服务器执行）</h4>
                <pre><code># 编辑 SSH 配置
sudo nano /etc/ssh/sshd_config

# 修改以下配置
PasswordAuthentication no
PubkeyAuthentication yes

# 重启 SSH
sudo systemctl restart sshd</code></pre>
            </div>

            <h3>3. 安装 fail2ban 防暴力破解</h3>
            <div class="info-box">
                <pre><code># 安装 fail2ban
sudo apt update
sudo apt install fail2ban -y

# 启动服务
sudo systemctl start fail2ban
sudo systemctl enable fail2ban

# 查看状态
sudo fail2ban-client status sshd</code></pre>
            </div>

            <h2>防火墙配置</h2>

            <h3>使用 UFW（简单）</h3>
            <div class="info-box">
                <pre><code># 安装 UFW
sudo apt install ufw -y

# 允许 SSH（改成你的 SSH 端口）
sudo ufw allow 50022/tcp

# 允许代理端口（例如 443）
sudo ufw allow 443/tcp

# 启用防火墙
sudo ufw enable

# 查看状态
sudo ufw status</code></pre>
            </div>

            <h3>使用 iptables（进阶）</h3>
            <div class="info-box">
                <pre><code># 允许已建立的连接
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# 允许 SSH
iptables -A INPUT -p tcp --dport 50022 -j ACCEPT

# 允许代理端口
iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# 拒绝其他入站
iptables -P INPUT DROP

# 保存规则
iptables-save > /etc/iptables/rules.v4</code></pre>
            </div>

            <h2>协议安全配置</h2>

            <h3>强加密选择</h3>
            <table>
                <thead>
                    <tr>
                        <th>协议</th>
                        <th>推荐加密</th>
                        <th>不推荐</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Shadowsocks</strong></td>
                        <td>aes-256-gcm<br>chacha20-ietf-poly1305</td>
                        <td>rc4-md5<br>aes-128-cfb</td>
                    </tr>
                    <tr>
                        <td><strong>Xray/V2Ray</strong></td>
                        <td>VLESS + TLS 1.3<br>VLESS + Reality</td>
                        <td>VMess + 无加密</td>
                    </tr>
                    <tr>
                        <td><strong>Trojan</strong></td>
                        <td>TLS 1.3<br>正规证书</td>
                        <td>自签名证书</td>
                    </tr>
                </tbody>
            </table>

            <h3>TLS 证书配置</h3>
            <div class="info-box">
                <h4>使用 acme.sh 申请免费证书</h4>
                <pre><code># 安装 acme.sh
curl https://get.acme.sh | sh

# 申请证书（需要域名）
acme.sh --issue -d yourdomain.com --standalone

# 安装证书
acme.sh --install-cert -d yourdomain.com \
  --key-file /etc/xray/key.pem \
  --fullchain-file /etc/xray/cert.pem</code></pre>
            </div>

            <h2>隐蔽性优化</h2>

            <h3>1. 端口伪装</h3>
            <ul>
                <li>✅ <strong>443</strong> - HTTPS 标准端口，最安全</li>
                <li>✅ <strong>80</strong> - HTTP 标准端口</li>
                <li>⚠️ 避免使用 8080、1080、10086 等明显的代理端口</li>
            </ul>

            <h3>2. 流量伪装</h3>
            <table>
                <thead>
                    <tr>
                        <th>方案</th>
                        <th>效果</th>
                        <th>复杂度</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>VLESS + Reality</strong></td>
                        <td>⭐⭐⭐⭐⭐ 完美伪装</td>
                        <td>⭐⭐⭐ 中等</td>
                    </tr>
                    <tr>
                        <td><strong>WebSocket + TLS</strong></td>
                        <td>⭐⭐⭐⭐ 很好</td>
                        <td>⭐⭐⭐ 中等</td>
                    </tr>
                    <tr>
                        <td><strong>CDN 中转</strong></td>
                        <td>⭐⭐⭐⭐ 很好</td>
                        <td>⭐⭐⭐⭐ 较高</td>
                    </tr>
                    <tr>
                        <td><strong>前置网站</strong></td>
                        <td>⭐⭐⭐⭐ 很好</td>
                        <td>⭐⭐ 简单</td>
                    </tr>
                </tbody>
            </table>

            <h3>3. 搭建伪装网站</h3>
            <div class="info-box">
                <h4>简单方案：使用 Nginx 前置</h4>
                <pre><code># 安装 Nginx
sudo apt install nginx -y

# 放置一个静态网站到 /var/www/html
# 配置 Nginx 反代到代理端口

# 这样访问 80/443 显示正常网站
# 特定路径才是代理</code></pre>
            </div>

            <h3>4. 流量特征识别与对抗</h3>
            <div class="info-box">
                <p>很多封锁/审查并不是“解密你的内容”，而是通过<strong>流量特征</strong>（时序、包长、握手、指纹）来判断你是不是在跑代理。</p>

                <h4>常见识别维度</h4>
                <ul>
                    <li><strong>DPI</strong>：检查协议握手特征、可疑字段、异常包序列</li>
                    <li><strong>TLS 指纹</strong>：JA3/JA4、ALPN、扩展顺序、SNI 行为等</li>
                    <li><strong>行为特征</strong>：长连接占比、突发大流量、频繁重连、特定端口模式</li>
                </ul>

                <h4>实用对抗策略（由易到难）</h4>
                <ul>
                    <li>✅ 选对协议：优先 <strong>VLESS + Reality</strong>，其次 Trojan/WS+TLS + 正常站点</li>
                    <li>✅ 走常见端口：443/80，避免明显代理端口</li>
                    <li>✅ 配置回落/伪装站：探测时返回正常网页内容</li>
                    <li>✅ 控制异常行为：避免 BT/长时间大下载；减少频繁断开重连</li>
                </ul>
            </div>

            <h3>5. WebRTC 泄露 / IP 泄露测试</h3>
            <div class="warning-box">
                <p>即使代理开了，浏览器也可能通过 WebRTC、DNS 或系统直连路径暴露真实网络信息。</p>

                <h4>常用自测站点</h4>
                <ul>
                    <li>WebRTC：<a href="https://browserleaks.com/webrtc" target="_blank" rel="noopener">browserleaks.com/webrtc</a></li>
                    <li>IP 信息：<a href="https://ipinfo.io/" target="_blank" rel="noopener">ipinfo.io</a></li>
                    <li>DNS 泄露：<a href="https://www.dnsleaktest.com/" target="_blank" rel="noopener">dnsleaktest.com</a></li>
                </ul>

                <h4>常见修复方向</h4>
                <ul>
                    <li>✅ 客户端启用 TUN / 全局模式（按需）</li>
                    <li>✅ 在浏览器/客户端中禁用或限制 WebRTC（不同浏览器入口不同）</li>
                    <li>✅ DNS 走代理/加密 DNS，避免直连 DNS</li>
                </ul>
            </div>

            <h3>6. 浏览器指纹防护</h3>
            <div class="info-box">
                <p>“指纹”不是单一特征，而是很多信息的组合（字体、Canvas、WebGL、时区、语言、插件、屏幕参数）。代理只能改 IP，<strong>不等于</strong>隐藏指纹。</p>

                <h4>降低指纹可识别度的思路</h4>
                <ul>
                    <li>✅ 使用隐私向浏览器（Firefox + 合理隐私配置 / Brave / Tor Browser）</li>
                    <li>✅ 减少插件数量，避免安装“很小众”的扩展</li>
                    <li>✅ 避免频繁切换 UA、分辨率、语言、时区（反而更异常）</li>
                    <li>✅ 需要更强匿名时：考虑隔离环境（独立浏览器配置/容器/虚拟机）</li>
                </ul>
            </div>

            <h2>流量控制</h2>

            <h3>限制连接数</h3>
            <div class="info-box">
                <p>在面板中设置每个用户的：</p>
                <ul>
                    <li>最大连接数：3-5 个（防止共享）</li>
                    <li>流量限制：根据需求设置</li>
                    <li>到期时间：定期更换</li>
                </ul>
            </div>

            <h3>避免异常流量</h3>
            <div class="warning-box">
                <h4>⚠️ 容易被封的行为</h4>
                <ul>
                    <li>❌ 长时间大流量下载（BT、迅雷）</li>
                    <li>❌ 频繁连接断开</li>
                    <li>❌ 使用垃圾邮件服务</li>
                    <li>❌ 端口扫描、攻击行为</li>
                </ul>
            </div>

            <h2>定期维护</h2>

            <h3>系统更新</h3>
            <div class="info-box">
                <pre><code># 每月执行一次
sudo apt update
sudo apt upgrade -y

# 重启服务
sudo reboot</code></pre>
            </div>

            <h3>日志检查</h3>
            <div class="info-box">
                <pre><code># 查看 SSH 登录日志
sudo tail -f /var/log/auth.log

# 查看系统日志
sudo journalctl -xe

# 查看代理日志（以 xray 为例）
sudo journalctl -u xray -f</code></pre>
            </div>

            <h3>备份配置</h3>
            <div class="info-box">
                <pre><code># 备份重要配置
tar -czf backup-$(date +%Y%m%d).tar.gz \
  /etc/xray \
  /etc/nginx \
  /etc/ssh

# 下载到本地
scp -P 50022 root@your-vps-ip:backup-*.tar.gz ./</code></pre>
            </div>

            <h2>紧急处理</h2>

            <h3>IP 被墙后的处理</h3>
            <div class="warning-box">
                <ol>
                    <li>立即停止代理服务</li>
                    <li>备份重要数据和配置</li>
                    <li>更换服务器 IP 或重建 VPS</li>
                    <li>分析被封原因，调整配置</li>
                </ol>
            </div>

            <h2>安全检查清单</h2>

            <div class="success-box">
                <h4>✅ 部署后必须完成</h4>
                <ul>
                    <li>□ 修改 SSH 默认端口</li>
                    <li>□ 配置 SSH 密钥登录</li>
                    <li>□ 禁用密码登录</li>
                    <li>□ 安装配置防火墙</li>
                    <li>□ 安装 fail2ban</li>
                    <li>□ 使用强加密协议</li>
                    <li>□ 配置端口伪装（443）</li>
                    <li>□ 启用 TLS 加密</li>
                    <li>□ 限制连接数和流量</li>
                    <li>□ 备份配置文件</li>
                </ul>
            </div>

            <h2>下一步学习</h2>
            <div class="success-box">
                <p>加固安全后，建议学习：</p>
                <ul>
                    <li><a href="gfw.html">GFW 检测原理</a> - 了解如何被检测</li>
                    <li><a href="ip-blocking.html">IP 封禁机制</a> - 理解封禁原理</li>
                    <li><a href="advanced.html">进阶优化</a> - 进一步提升隐蔽性</li>
                </ul>
            </div>
        </main>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2024 Proxy 101 知识库. 仅供技术学习使用.</p>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
</body>
</html>
